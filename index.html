<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard SFICHIPS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #25D366;
            --primary-dark: #128C7E;
            --secondary: #54656F;
            --light-bg: #F0F2F5;
            --card-bg: #FFFFFF;
            --text-dark: #3B4A54;
            --text-light: #667781;
            --matrix-color: #2ecc71;
            --dealers-color: #e74c3c;
            --aspirado-color: #3498db;
            --turbo-color: #9b59b6;
            --border-radius: 12px;
            --shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Helvetica, Arial, sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--text-dark);
            line-height: 1.6;
            padding: 20px;
        }

        .dashboard-container {
            max-width: 1800px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-dark), #2c3e50);
            color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
            font-weight: 600;
        }

        .logo i {
            font-size: 28px;
        }

        .date-filter {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .date-input {
            padding: 8px 12px;
            border: none;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 14px;
        }

        .filter-btn {
            padding: 8px 16px;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .filter-btn:hover {
            background: white;
            color: var(--primary-dark);
        }

        /* Cards de Resumo Geral */
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .summary-card:hover {
            transform: translateY(-5px);
        }

        .summary-card.highlight {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-light);
        }

        .summary-card.highlight .card-title {
            color: rgba(255, 255, 255, 0.9);
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .leads-icon {
            background-color: var(--primary);
        }

        .investment-icon {
            background-color: var(--aspirado-color);
        }

        .cpl-icon {
            background-color: var(--turbo-color);
        }

        .card-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .summary-card.highlight .card-value {
            color: white;
        }

        .card-change {
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .positive {
            color: var(--primary);
        }

        .negative {
            color: #E74C3C;
        }

        .summary-card.highlight .card-change {
            color: rgba(255, 255, 255, 0.9);
        }

        /* Comparação Matriz vs Dealers */
        .section-title {
            font-size: 22px;
            margin: 30px 0 20px;
            color: var(--text-dark);
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
        }

        .comparison-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .comparison-box {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .comparison-box.matrix {
            border-top: 5px solid var(--matrix-color);
        }

        .comparison-box.dealers {
            border-top: 5px solid var(--dealers-color);
        }

        .comparison-box h2 {
            font-size: 20px;
            margin-bottom: 20px;
            text-align: center;
            color: var(--text-dark);
        }

        .comparison-data {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .comparison-item {
            text-align: center;
            padding: 20px;
            border-radius: 8px;
        }

        .comparison-item h3 {
            font-size: 14px;
            color: var(--text-light);
            margin-bottom: 10px;
        }

        .comparison-item .value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .comparison-item .subvalue {
            font-size: 12px;
            color: var(--text-light);
        }

        .matrix-bg {
            background-color: rgba(46, 204, 113, 0.1);
        }

        .dealers-bg {
            background-color: rgba(231, 76, 60, 0.1);
        }

        /* Gráficos */
        .charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-comparison-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 25px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
        }

        .chart-container {
            height: 300px;
            position: relative;
        }

        /* Tabela */
        .data-table-container {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 25px;
            margin-bottom: 30px;
            overflow-x: auto;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .comparison-table th, .comparison-table td {
            padding: 12px 15px;
            text-align: center;
            border-bottom: 1px solid #e0e0e0;
        }

        .comparison-table th {
            background-color: var(--light-bg);
            font-weight: 600;
            color: var(--primary-dark);
            font-size: 14px;
        }

        .comparison-table th:first-child {
            text-align: left;
        }

        .comparison-table td:first-child {
            text-align: left;
            font-weight: 600;
            color: var(--text-dark);
        }

        .comparison-table tr:hover {
            background-color: #f9f9f9;
        }

        .matrix-header {
            background-color: rgba(46, 204, 113, 0.1);
            color: var(--matrix-color);
        }

        .dealers-header {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--dealers-color);
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            color: var(--text-light);
            font-size: 14px;
        }

        @media (max-width: 1200px) {
            .charts-container,
            .chart-comparison-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 992px) {
            .comparison-container {
                grid-template-columns: 1fr;
            }
            
            .summary-cards {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 15px;
            }
            
            .date-filter {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .comparison-data {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <header>
            <div class="logo">
                <i class="fab fa-whatsapp"></i>
                <span>SFICHIPSNORDESTE - Dashboard Completo</span>
            </div>
            <div class="date-filter">
                <input type="date" id="startDate" class="date-input">
                <span style="color: white;">até</span>
                <input type="date" id="endDate" class="date-input">
                <button class="filter-btn" id="applyFilter">
                    <i class="fas fa-filter"></i> Filtrar
                </button>
            </div>
        </header>

        <!-- Resumo Geral -->
        <div class="summary-cards">
            <div class="summary-card highlight">
                <div class="card-header">
                    <div class="card-title">Total de Leads</div>
                    <div class="card-icon leads-icon">
                        <i class="fas fa-users"></i>
                    </div>
                </div>
                <div class="card-value" id="totalLeads">0</div>
                <div class="card-change positive">
                    <i class="fas fa-arrow-up"></i>
                    <span id="leadsChange">Período completo</span>
                </div>
            </div>

            <div class="summary-card">
                <div class="card-header">
                    <div class="card-title">Investimento Total</div>
                    <div class="card-icon investment-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                </div>
                <div class="card-value" id="totalInvestment">R$ 0,00</div>
                <div class="card-change positive">
                    <i class="fas fa-arrow-up"></i>
                    <span id="investmentChange">Total investido</span>
                </div>
            </div>

            <div class="summary-card">
                <div class="card-header">
                    <div class="card-title">CPL Médio</div>
                    <div class="card-icon cpl-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                </div>
                <div class="card-value" id="averageCPL">R$ 0,00</div>
                <div class="card-change negative">
                    <i class="fas fa-arrow-down"></i>
                    <span id="cplChange">Custo por lead</span>
                </div>
            </div>
        </div>

        <!-- Comparação Matriz vs Dealers -->
        <h2 class="section-title">Comparativo Matriz vs Dealers</h2>
        <div class="comparison-container">
            <div class="comparison-box matrix">
                <h2>MATRIZ</h2>
                <div class="comparison-data">
                    <div class="comparison-item matrix-bg">
                        <h3>Total de Leads</h3>
                        <div class="value" id="matrixTotalLeads">0</div>
                        <div class="subvalue" id="matrixLeadsShare">0% do total</div>
                    </div>
                    <div class="comparison-item matrix-bg">
                        <h3>Orçamento Total</h3>
                        <div class="value" id="matrixTotalBudget">R$ 0,00</div>
                        <div class="subvalue" id="matrixBudgetShare">0% do total</div>
                    </div>
                    <div class="comparison-item matrix-bg">
                        <h3>Aspirados</h3>
                        <div class="value" id="matrixAspiradoLeads">0</div>
                        <div class="subvalue" id="matrixAspiradoShare">0% dos leads</div>
                    </div>
                    <div class="comparison-item matrix-bg">
                        <h3>Turbo</h3>
                        <div class="value" id="matrixTurboLeads">0</div>
                        <div class="subvalue" id="matrixTurboShare">0% dos leads</div>
                    </div>
                </div>
            </div>
            
            <div class="comparison-box dealers">
                <h2>DEALERS</h2>
                <div class="comparison-data">
                    <div class="comparison-item dealers-bg">
                        <h3>Total de Leads</h3>
                        <div class="value" id="dealersTotalLeads">0</div>
                        <div class="subvalue" id="dealersLeadsShare">0% do total</div>
                    </div>
                    <div class="comparison-item dealers-bg">
                        <h3>Orçamento Total</h3>
                        <div class="value" id="dealersTotalBudget">R$ 0,00</div>
                        <div class="subvalue" id="dealersBudgetShare">0% do total</div>
                    </div>
                    <div class="comparison-item dealers-bg">
                        <h3>Aspirados</h3>
                        <div class="value" id="dealersAspiradoLeads">0</div>
                        <div class="subvalue" id="dealersAspiradoShare">0% dos leads</div>
                    </div>
                    <div class="comparison-item dealers-bg">
                        <h3>Turbo</h3>
                        <div class="value" id="dealersTurboLeads">0</div>
                        <div class="subvalue" id="dealersTurboShare">0% dos leads</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gráficos Comparativos -->
        <h2 class="section-title">Gráficos Comparativos</h2>
        <div class="chart-comparison-container">
            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">Leads por Dia - Matriz vs Dealers</div>
                </div>
                <div class="chart-container">
                    <canvas id="leadsComparisonChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">Orçamento por Dia - Matriz vs Dealers</div>
                </div>
                <div class="chart-container">
                    <canvas id="budgetComparisonChart"></canvas>
                </div>
            </div>
        </div>

        <div class="chart-comparison-container">
            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">Matriz - Aspirado vs Turbo</div>
                </div>
                <div class="chart-container">
                    <canvas id="matrixPieChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">Dealers - Aspirado vs Turbo</div>
                </div>
                <div class="chart-container">
                    <canvas id="dealersPieChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Tabela Detalhada -->
        <h2 class="section-title">Desempenho Detalhado por Data</h2>
        <div class="data-table-container">
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th rowspan="2">Data</th>
                        <th rowspan="2">Total Leads</th>
                        <th rowspan="2">CPL</th>
                        <th rowspan="2">Orçamento Total</th>
                        <th colspan="6" class="matrix-header">MATRIZ</th>
                        <th colspan="4" class="dealers-header">DEALERS</th>
                    </tr>
                    <tr>
                        <th class="matrix-header">Aspirado</th>
                        <th class="matrix-header">Turbo</th>
                        <th class="matrix-header">Total</th>
                        <th class="matrix-header">Orçamento</th>
                        <th class="matrix-header">Aspirado</th>
                        <th class="matrix-header">Turbo</th>
                        <th class="dealers-header">Total</th>
                        <th class="dealers-header">Orçamento</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- Dados serão preenchidos via JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- Gráficos Adicionais -->
        <h2 class="section-title">Análise de Tendências</h2>
        <div class="charts-container">
            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">Evolução de Leads ao Longo do Tempo</div>
                </div>
                <div class="chart-container">
                    <canvas id="leadsTrendChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">Distribuição entre Matriz e Dealers</div>
                </div>
                <div class="chart-container">
                    <canvas id="channelDistributionChart"></canvas>
                </div>
            </div>
        </div>

        <footer>
            <p>Dashboard SFICHIPSNORDESTE - Análise Completa de Performance | Desenvolvido para análise estratégica</p>
        </footer>
    </div>

    <script>
        // Dados completos convertidos do PDF
        const rawData = [
            // Setembro 2025
            {data: '2025-09-01', totalLeads: 48, cpl: 6.58, totalBudget: 315.67, 
             matrizAspirado: 12, matrizTurbo: 8, matrizTotal: 20, matrizBudget: 131.53,
             dealersAspirado: 16, dealersTurbo: 8, dealersTotal: 24, dealersBudget: 157.84},
             
            {data: '2025-09-02', totalLeads: 91, cpl: 3.61, totalBudget: 328.66,
             matrizAspirado: 23, matrizTurbo: 6, matrizTotal: 29, matrizBudget: 104.74,
             dealersAspirado: 36, dealersTurbo: 22, dealersTotal: 58, dealersBudget: 209.48},
             
            {data: '2025-09-03', totalLeads: 78, cpl: 4.31, totalBudget: 336.25,
             matrizAspirado: 16, matrizTurbo: 7, matrizTotal: 23, matrizBudget: 99.15,
             dealersAspirado: 33, dealersTurbo: 17, dealersTotal: 50, dealersBudget: 215.54},
             
            {data: '2025-09-04', totalLeads: 49, cpl: 9.37, totalBudget: 458.97,
             matrizAspirado: 12, matrizTurbo: 6, matrizTotal: 18, matrizBudget: 168.60,
             dealersAspirado: 19, dealersTurbo: 8, dealersTotal: 27, dealersBudget: 252.90},
             
            {data: '2025-09-05', totalLeads: 67, cpl: 3.48, totalBudget: 232.94,
             matrizAspirado: 17, matrizTurbo: 9, matrizTotal: 26, matrizBudget: 90.39,
             dealersAspirado: 19, dealersTurbo: 18, dealersTotal: 37, dealersBudget: 128.64},
             
            {data: '2025-09-06', totalLeads: 26, cpl: 10.45, totalBudget: 271.82,
             matrizAspirado: 6, matrizTurbo: 5, matrizTotal: 11, matrizBudget: 115.00,
             dealersAspirado: 9, dealersTurbo: 3, dealersTotal: 12, dealersBudget: 125.46},
             
            {data: '2025-09-07', totalLeads: 102, cpl: 5.76, totalBudget: 587.28,
             matrizAspirado: 18, matrizTurbo: 20, matrizTotal: 38, matrizBudget: 218.79,
             dealersAspirado: 33, dealersTurbo: 25, dealersTotal: 58, dealersBudget: 333.94},
             
            {data: '2025-09-08', totalLeads: 50, cpl: 3.92, totalBudget: 196.12,
             matrizAspirado: 4, matrizTurbo: 4, matrizTotal: 8, matrizBudget: 31.38,
             dealersAspirado: 14, dealersTurbo: 7, dealersTotal: 21, dealersBudget: 82.37},
             
            {data: '2025-09-09', totalLeads: 75, cpl: 5.47, totalBudget: 410.51,
             matrizAspirado: 0, matrizTurbo: 0, matrizTotal: 0, matrizBudget: 0.00,
             dealersAspirado: 0, dealersTurbo: 1, dealersTotal: 1, dealersBudget: 5.47},
             
            {data: '2025-09-10', totalLeads: 92, cpl: 3.78, totalBudget: 347.36,
             matrizAspirado: 59, matrizTurbo: 40, matrizTotal: 99, matrizBudget: 373.79,
             dealersAspirado: 65, dealersTurbo: 33, dealersTotal: 98, dealersBudget: 370.01},
             
            {data: '2025-09-11', totalLeads: 78, cpl: 4.50, totalBudget: 351.22,
             matrizAspirado: 34, matrizTurbo: 12, matrizTotal: 46, matrizBudget: 207.13,
             dealersAspirado: 22, dealersTurbo: 9, dealersTotal: 31, dealersBudget: 139.59},
             
            {data: '2025-09-12', totalLeads: 77, cpl: 4.17, totalBudget: 320.78,
             matrizAspirado: 21, matrizTurbo: 6, matrizTotal: 27, matrizBudget: 112.48,
             dealersAspirado: 31, dealersTurbo: 18, dealersTotal: 49, dealersBudget: 204.13},
             
            {data: '2025-09-13', totalLeads: 58, cpl: 5.00, totalBudget: 290.10,
             matrizAspirado: 17, matrizTurbo: 9, matrizTotal: 26, matrizBudget: 130.04,
             dealersAspirado: 19, dealersTurbo: 7, dealersTotal: 26, dealersBudget: 130.04},
             
            {data: '2025-09-14', totalLeads: 84, cpl: 4.11, totalBudget: 345.52,
             matrizAspirado: 25, matrizTurbo: 5, matrizTotal: 30, matrizBudget: 123.40,
             dealersAspirado: 42, dealersTurbo: 8, dealersTotal: 50, dealersBudget: 205.67},
             
            {data: '2025-09-15', totalLeads: 73, cpl: 3.81, totalBudget: 278.27,
             matrizAspirado: 15, matrizTurbo: 3, matrizTotal: 18, matrizBudget: 68.61,
             dealersAspirado: 25, dealersTurbo: 8, dealersTotal: 33, dealersBudget: 125.79},
             
            {data: '2025-09-16', totalLeads: 71, cpl: 3.10, totalBudget: 220.35,
             matrizAspirado: 0, matrizTurbo: 0, matrizTotal: 0, matrizBudget: 0.00,
             dealersAspirado: 0, dealersTurbo: 0, dealersTotal: 0, dealersBudget: 0.00},
             
            {data: '2025-09-17', totalLeads: 60, cpl: 3.18, totalBudget: 190.55,
             matrizAspirado: 37, matrizTurbo: 15, matrizTotal: 52, matrizBudget: 165.14,
             dealersAspirado: 61, dealersTurbo: 16, dealersTotal: 77, dealersBudget: 244.54},
             
            {data: '2025-09-18', totalLeads: 47, cpl: 4.17, totalBudget: 195.98,
             matrizAspirado: 0, matrizTurbo: 0, matrizTotal: 0, matrizBudget: 0.00,
             dealersAspirado: 0, dealersTurbo: 0, dealersTotal: 0, dealersBudget: 0.00},
             
            {data: '2025-09-19', totalLeads: 41, cpl: 4.64, totalBudget: 190.21,
             matrizAspirado: 35, matrizTurbo: 14, matrizTotal: 49, matrizBudget: 227.32,
             dealersAspirado: 30, dealersTurbo: 19, dealersTotal: 49, dealersBudget: 227.32},
             
            {data: '2025-09-20', totalLeads: 49, cpl: 3.92, totalBudget: 192.04,
             matrizAspirado: 14, matrizTurbo: 11, matrizTotal: 25, matrizBudget: 97.98,
             dealersAspirado: 16, dealersTurbo: 8, dealersTotal: 24, dealersBudget: 94.06},
             
            {data: '2025-09-21', totalLeads: 72, cpl: 3.94, totalBudget: 283.53,
             matrizAspirado: 19, matrizTurbo: 11, matrizTotal: 30, matrizBudget: 118.14,
             dealersAspirado: 27, dealersTurbo: 12, dealersTotal: 40, dealersBudget: 157.52},
             
            {data: '2025-09-22', totalLeads: 76, cpl: 4.16, totalBudget: 316.12,
             matrizAspirado: 16, matrizTurbo: 6, matrizTotal: 22, matrizBudget: 91.51,
             dealersAspirado: 31, dealersTurbo: 18, dealersTotal: 49, dealersBudget: 203.81},
             
            {data: '2025-09-23', totalLeads: 67, cpl: 4.25, totalBudget: 284.71,
             matrizAspirado: 10, matrizTurbo: 6, matrizTotal: 16, matrizBudget: 67.99,
             dealersAspirado: 11, dealersTurbo: 4, dealersTotal: 15, dealersBudget: 63.74},
             
            {data: '2025-09-24', totalLeads: 79, cpl: 3.54, totalBudget: 279.40,
             matrizAspirado: 26, matrizTurbo: 11, matrizTotal: 37, matrizBudget: 130.86,
             dealersAspirado: 48, dealersTurbo: 25, dealersTotal: 73, dealersBudget: 258.18},
             
            {data: '2025-09-25', totalLeads: 87, cpl: 3.36, totalBudget: 292.08,
             matrizAspirado: 18, matrizTurbo: 11, matrizTotal: 29, matrizBudget: 97.36,
             dealersAspirado: 34, dealersTurbo: 21, dealersTotal: 55, dealersBudget: 184.65},
             
            {data: '2025-09-26', totalLeads: 73, cpl: 3.90, totalBudget: 284.65,
             matrizAspirado: 18, matrizTurbo: 11, matrizTotal: 29, matrizBudget: 113.08,
             dealersAspirado: 27, dealersTurbo: 16, dealersTotal: 43, dealersBudget: 167.67},
             
            {data: '2025-09-27', totalLeads: 75, cpl: 3.92, totalBudget: 293.91,
             matrizAspirado: 21, matrizTurbo: 8, matrizTotal: 29, matrizBudget: 113.65,
             dealersAspirado: 25, dealersTurbo: 16, dealersTotal: 41, dealersBudget: 160.67},
             
            {data: '2025-09-28', totalLeads: 53, cpl: 6.28, totalBudget: 332.81,
             matrizAspirado: 22, matrizTurbo: 5, matrizTotal: 27, matrizBudget: 169.54,
             dealersAspirado: 18, dealersTurbo: 6, dealersTotal: 24, dealersBudget: 150.71},
             
            {data: '2025-09-29', totalLeads: 81, cpl: 3.68, totalBudget: 298.22,
             matrizAspirado: 26, matrizTurbo: 17, matrizTotal: 43, matrizBudget: 158.31,
             dealersAspirado: 19, dealersTurbo: 16, dealersTotal: 35, dealersBudget: 128.86},
             
            {data: '2025-09-30', totalLeads: 77, cpl: 3.82, totalBudget: 294.15,
             matrizAspirado: 12, matrizTurbo: 10, matrizTotal: 22, matrizBudget: 84.04,
             dealersAspirado: 17, dealersTurbo: 16, dealersTotal: 33, dealersBudget: 126.06},
             
            // Outubro 2025
            {data: '2025-10-01', totalLeads: 73, cpl: 4.03, totalBudget: 293.90,
             matrizAspirado: 24, matrizTurbo: 7, matrizTotal: 31, matrizBudget: 124.81,
             dealersAspirado: 25, dealersTurbo: 16, dealersTotal: 41, dealersBudget: 165.07},
             
            {data: '2025-10-02', totalLeads: 81, cpl: 3.70, totalBudget: 299.32,
             matrizAspirado: 28, matrizTurbo: 12, matrizTotal: 40, matrizBudget: 147.81,
             dealersAspirado: 30, dealersTurbo: 11, dealersTotal: 41, dealersBudget: 151.51},
             
            {data: '2025-10-03', totalLeads: 73, cpl: 3.91, totalBudget: 285.13,
             matrizAspirado: 22, matrizTurbo: 12, matrizTotal: 34, matrizBudget: 132.80,
             dealersAspirado: 25, dealersTurbo: 12, dealersTotal: 37, dealersBudget: 144.52},
             
            {data: '2025-10-04', totalLeads: 64, cpl: 4.28, totalBudget: 273.70,
             matrizAspirado: 20, matrizTurbo: 6, matrizTotal: 26, matrizBudget: 111.19,
             dealersAspirado: 17, dealersTurbo: 11, dealersTotal: 28, dealersBudget: 119.74},
             
            {data: '2025-10-05', totalLeads: 65, cpl: 5.00, totalBudget: 324.91,
             matrizAspirado: 0, matrizTurbo: 0, matrizTotal: 0, matrizBudget: 0.00,
             dealersAspirado: 0, dealersTurbo: 0, dealersTotal: 0, dealersBudget: 0.00},
             
            {data: '2025-10-06', totalLeads: 58, cpl: 4.97, totalBudget: 288.37,
             matrizAspirado: 43, matrizTurbo: 11, matrizTotal: 54, matrizBudget: 268.48,
             dealersAspirado: 51, dealersTurbo: 20, dealersTotal: 71, dealersBudget: 353.00},
             
            {data: '2025-10-07', totalLeads: 50, cpl: 5.87, totalBudget: 293.40,
             matrizAspirado: 21, matrizTurbo: 3, matrizTotal: 24, matrizBudget: 140.83,
             dealersAspirado: 16, dealersTurbo: 7, dealersTotal: 23, dealersBudget: 134.96},
             
            {data: '2025-10-08', totalLeads: 64, cpl: 4.57, totalBudget: 292.70,
             matrizAspirado: 22, matrizTurbo: 9, matrizTotal: 31, matrizBudget: 141.78,
             dealersAspirado: 22, dealersTurbo: 8, dealersTotal: 30, dealersBudget: 137.20},
             
            {data: '2025-10-09', totalLeads: 74, cpl: 4.94, totalBudget: 365.56,
             matrizAspirado: 13, matrizTurbo: 11, matrizTotal: 24, matrizBudget: 118.44,
             dealersAspirado: 29, dealersTurbo: 19, dealersTotal: 48, dealersBudget: 236.89},
             
            {data: '2025-10-10', totalLeads: 121, cpl: 3.70, totalBudget: 447.86,
             matrizAspirado: 16, matrizTurbo: 7, matrizTotal: 23, matrizBudget: 85.13,
             dealersAspirado: 61, dealersTurbo: 24, dealersTotal: 85, dealersBudget: 277.60},
             
            {data: '2025-10-11', totalLeads: 146, cpl: 3.29, totalBudget: 479.64,
             matrizAspirado: 18, matrizTurbo: 8, matrizTotal: 26, matrizBudget: 85.42,
             dealersAspirado: 70, dealersTurbo: 32, dealersTotal: 102, dealersBudget: 355.99},
             
            {data: '2025-10-12', totalLeads: 168, cpl: 3.37, totalBudget: 565.95,
             matrizAspirado: 11, matrizTurbo: 10, matrizTotal: 21, matrizBudget: 70.74,
             dealersAspirado: 60, dealersTurbo: 40, dealersTotal: 100, dealersBudget: 303.19},
             
            {data: '2025-10-13', totalLeads: 169, cpl: 3.36, totalBudget: 567.84,
             matrizAspirado: 6, matrizTurbo: 4, matrizTotal: 10, matrizBudget: 33.60,
             dealersAspirado: 53, dealersTurbo: 23, dealersTotal: 76, dealersBudget: 255.36},
             
            {data: '2025-10-14', totalLeads: 67, cpl: 5.43, totalBudget: 363.81,
             matrizAspirado: 22, matrizTurbo: 8, matrizTotal: 30, matrizBudget: 162.90,
             dealersAspirado: 60, dealersTurbo: 24, dealersTotal: 84, dealersBudget: 456.12},
             
            {data: '2025-10-15', totalLeads: 91, cpl: 4.41, totalBudget: 401.05,
             matrizAspirado: 22, matrizTurbo: 8, matrizTotal: 30, matrizBudget: 132.30,
             dealersAspirado: 37, dealersTurbo: 21, dealersTotal: 58, dealersBudget: 255.75},
             
            {data: '2025-10-16', totalLeads: 72, cpl: 5.33, totalBudget: 383.76,
             matrizAspirado: 23, matrizTurbo: 8, matrizTotal: 31, matrizBudget: 165.23,
             dealersAspirado: 28, dealersTurbo: 14, dealersTotal: 42, dealersBudget: 223.93},
             
            {data: '2025-10-17', totalLeads: 66, cpl: 6.93, totalBudget: 457.38,
             matrizAspirado: 12, matrizTurbo: 6, matrizTotal: 18, matrizBudget: 124.74,
             dealersAspirado: 22, dealersTurbo: 14, dealersTotal: 36, dealersBudget: 249.48},
             
            {data: '2025-10-18', totalLeads: 64, cpl: 5.55, totalBudget: 355.20,
             matrizAspirado: 8, matrizTurbo: 2, matrizTotal: 10, matrizBudget: 55.50,
             dealersAspirado: 8, dealersTurbo: 15, dealersTotal: 23, dealersBudget: 127.65},
             
            {data: '2025-10-19', totalLeads: 88, cpl: 4.99, totalBudget: 439.12,
             matrizAspirado: 38, matrizTurbo: 14, matrizTotal: 52, matrizBudget: 259.48,
             dealersAspirado: 43, dealersTurbo: 20, dealersTotal: 63, dealersBudget: 314.37},
             
            {data: '2025-10-20', totalLeads: 44, cpl: 5.37, totalBudget: 236.28,
             matrizAspirado: 8, matrizTurbo: 4, matrizTotal: 12, matrizBudget: 64.44,
             dealersAspirado: 19, dealersTurbo: 12, dealersTotal: 31, dealersBudget: 166.47},
             
            {data: '2025-10-21', totalLeads: 65, cpl: 6.15, totalBudget: 399.75,
             matrizAspirado: 17, matrizTurbo: 10, matrizTotal: 27, matrizBudget: 166.05,
             dealersAspirado: 12, dealersTurbo: 12, dealersTotal: 24, dealersBudget: 147.60},
             
            {data: '2025-10-22', totalLeads: 17, cpl: 6.25, totalBudget: 106.25,
             matrizAspirado: 8, matrizTurbo: 5, matrizTotal: 13, matrizBudget: 81.25,
             dealersAspirado: 6, dealersTurbo: 8, dealersTotal: 14, dealersBudget: 87.50}
        ];

        // Variáveis para os gráficos
        let leadsComparisonChart, budgetComparisonChart, matrixPieChart, dealersPieChart, leadsTrendChart, channelDistributionChart;

        document.addEventListener('DOMContentLoaded', function() {
            // Configurar datas padrão
            const startDate = '2025-09-01';
            const endDate = '2025-10-22';
            
            document.getElementById('startDate').value = startDate;
            document.getElementById('endDate').value = endDate;
            
            // Aplicar filtro inicial
            applyDateFilter();
            
            // Configurar evento do botão de filtro
            document.getElementById('applyFilter').addEventListener('click', applyDateFilter);
        });

        function applyDateFilter() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            
            if (!startDate || !endDate) {
                alert('Por favor, selecione ambas as datas.');
                return;
            }
            
            if (startDate > endDate) {
                alert('A data inicial não pode ser maior que a data final.');
                return;
            }
            
            // Filtrar dados pelo período selecionado
            const filteredData = rawData.filter(item => {
                return item.data >= startDate && item.data <= endDate;
            });
            
            // Calcular métricas e atualizar interface
            calculateMetrics(filteredData);
            updateTable(filteredData);
            updateCharts(filteredData);
        }

        function calculateMetrics(data) {
            if (data.length === 0) {
                alert('Nenhum dado encontrado para o período selecionado.');
                return;
            }
            
            // Calcular totais gerais
            let totalLeads = 0;
            let totalBudget = 0;
            let totalInvestment = 0;
            
            // Calcular totais por categoria
            let matrixTotalLeads = 0;
            let matrixTotalBudget = 0;
            let matrixAspiradoLeads = 0;
            let matrixTurboLeads = 0;
            
            let dealersTotalLeads = 0;
            let dealersTotalBudget = 0;
            let dealersAspiradoLeads = 0;
            let dealersTurboLeads = 0;
            
            data.forEach(item => {
                totalLeads += item.totalLeads;
                totalBudget += item.totalBudget;
                totalInvestment += item.totalBudget;
                
                matrixTotalLeads += item.matrizTotal;
                matrixTotalBudget += item.matrizBudget;
                matrixAspiradoLeads += item.matrizAspirado;
                matrixTurboLeads += item.matrizTurbo;
                
                dealersTotalLeads += item.dealersTotal;
                dealersTotalBudget += item.dealersBudget;
                dealersAspiradoLeads += item.dealersAspirado;
                dealersTurboLeads += item.dealersTurbo;
            });
            
            // Calcular CPL médio
            const averageCPL = totalLeads > 0 ? totalInvestment / totalLeads : 0;
            
            // Calcular shares
            const matrixLeadsShare = totalLeads > 0 ? (matrixTotalLeads / totalLeads) * 100 : 0;
            const matrixBudgetShare = totalInvestment > 0 ? (matrixTotalBudget / totalInvestment) * 100 : 0;
            const matrixAspiradoShare = matrixTotalLeads > 0 ? (matrixAspiradoLeads / matrixTotalLeads) * 100 : 0;
            const matrixTurboShare = matrixTotalLeads > 0 ? (matrixTurboLeads / matrixTotalLeads) * 100 : 0;
            
            const dealersLeadsShare = totalLeads > 0 ? (dealersTotalLeads / totalLeads) * 100 : 0;
            const dealersBudgetShare = totalInvestment > 0 ? (dealersTotalBudget / totalInvestment) * 100 : 0;
            const dealersAspiradoShare = dealersTotalLeads > 0 ? (dealersAspiradoLeads / dealersTotalLeads) * 100 : 0;
            const dealersTurboShare = dealersTotalLeads > 0 ? (dealersTurboLeads / dealersTotalLeads) * 100 : 0;
            
            // Atualizar interface - Resumo Geral
            document.getElementById('totalLeads').textContent = totalLeads.toLocaleString();
            document.getElementById('totalInvestment').textContent = `R$ ${totalInvestment.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            document.getElementById('averageCPL').textContent = `R$ ${averageCPL.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            
            // Atualizar Matriz
            document.getElementById('matrixTotalLeads').textContent = matrixTotalLeads.toLocaleString();
            document.getElementById('matrixTotalBudget').textContent = `R$ ${matrixTotalBudget.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            document.getElementById('matrixAspiradoLeads').textContent = matrixAspiradoLeads.toLocaleString();
            document.getElementById('matrixTurboLeads').textContent = matrixTurboLeads.toLocaleString();
            
            document.getElementById('matrixLeadsShare').textContent = `${matrixLeadsShare.toFixed(1)}% do total`;
            document.getElementById('matrixBudgetShare').textContent = `${matrixBudgetShare.toFixed(1)}% do total`;
            document.getElementById('matrixAspiradoShare').textContent = `${matrixAspiradoShare.toFixed(1)}% dos leads`;
            document.getElementById('matrixTurboShare').textContent = `${matrixTurboShare.toFixed(1)}% dos leads`;
            
            // Atualizar Dealers
            document.getElementById('dealersTotalLeads').textContent = dealersTotalLeads.toLocaleString();
            document.getElementById('dealersTotalBudget').textContent = `R$ ${dealersTotalBudget.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            document.getElementById('dealersAspiradoLeads').textContent = dealersAspiradoLeads.toLocaleString();
            document.getElementById('dealersTurboLeads').textContent = dealersTurboLeads.toLocaleString();
            
            document.getElementById('dealersLeadsShare').textContent = `${dealersLeadsShare.toFixed(1)}% do total`;
            document.getElementById('dealersBudgetShare').textContent = `${dealersBudgetShare.toFixed(1)}% do total`;
            document.getElementById('dealersAspiradoShare').textContent = `${dealersAspiradoShare.toFixed(1)}% dos leads`;
            document.getElementById('dealersTurboShare').textContent = `${dealersTurboShare.toFixed(1)}% dos leads`;
        }

        function updateTable(data) {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            data.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${formatDisplayDate(row.data)}</td>
                    <td>${row.totalLeads}</td>
                    <td>${row.cpl}</td>
                    <td>${row.totalBudget.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                    <td>${row.matrizAspirado}</td>
                    <td>${row.matrizTurbo}</td>
                    <td>${row.matrizTotal}</td>
                    <td>${row.matrizBudget.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                    <td>${row.dealersAspirado}</td>
                    <td>${row.dealersTurbo}</td>
                    <td>${row.dealersTotal}</td>
                    <td>${row.dealersBudget.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                `;
                tableBody.appendChild(tr);
            });
        }

        function updateCharts(data) {
            // Ordenar dados por data
            const sortedData = [...data].sort((a, b) => new Date(a.data) - new Date(b.data));
            
            // Preparar dados para os gráficos
            const labels = sortedData.map(item => formatDisplayDate(item.data));
            const matrixLeadsData = sortedData.map(item => item.matrizTotal);
            const dealersLeadsData = sortedData.map(item => item.dealersTotal);
            const matrixBudgetData = sortedData.map(item => item.matrizBudget);
            const dealersBudgetData = sortedData.map(item => item.dealersBudget);
            const totalLeadsData = sortedData.map(item => item.totalLeads);
            
            // Calcular totais para gráficos de pizza
            const matrixAspiradoTotal = sortedData.reduce((sum, item) => sum + item.matrizAspirado, 0);
            const matrixTurboTotal = sortedData.reduce((sum, item) => sum + item.matrizTurbo, 0);
            const dealersAspiradoTotal = sortedData.reduce((sum, item) => sum + item.dealersAspirado, 0);
            const dealersTurboTotal = sortedData.reduce((sum, item) => sum + item.dealersTurbo, 0);
            
            // Atualizar gráficos
            updateLeadsComparisonChart(labels, matrixLeadsData, dealersLeadsData);
            updateBudgetComparisonChart(labels, matrixBudgetData, dealersBudgetData);
            updateMatrixPieChart(matrixAspiradoTotal, matrixTurboTotal);
            updateDealersPieChart(dealersAspiradoTotal, dealersTurboTotal);
            updateLeadsTrendChart(labels, totalLeadsData, matrixLeadsData, dealersLeadsData);
            updateChannelDistributionChart(matrixAspiradoTotal + matrixTurboTotal, dealersAspiradoTotal + dealersTurboTotal);
        }

        function updateLeadsComparisonChart(labels, matrixData, dealersData) {
            const ctx = document.getElementById('leadsComparisonChart').getContext('2d');
            
            if (leadsComparisonChart) {
                leadsComparisonChart.destroy();
            }
            
            leadsComparisonChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Matriz',
                            data: matrixData,
                            backgroundColor: 'rgba(46, 204, 113, 0.7)',
                            borderColor: '#2ecc71',
                            borderWidth: 1
                        },
                        {
                            label: 'Dealers',
                            data: dealersData,
                            backgroundColor: 'rgba(231, 76, 60, 0.7)',
                            borderColor: '#e74c3c',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Quantidade de Leads'
                            }
                        }
                    }
                }
            });
        }

        function updateBudgetComparisonChart(labels, matrixData, dealersData) {
            const ctx = document.getElementById('budgetComparisonChart').getContext('2d');
            
            if (budgetComparisonChart) {
                budgetComparisonChart.destroy();
            }
            
            budgetComparisonChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Matriz',
                            data: matrixData,
                            backgroundColor: 'rgba(46, 204, 113, 0.7)',
                            borderColor: '#2ecc71',
                            borderWidth: 1
                        },
                        {
                            label: 'Dealers',
                            data: dealersData,
                            backgroundColor: 'rgba(231, 76, 60, 0.7)',
                            borderColor: '#e74c3c',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Orçamento (R$)'
                            }
                        }
                    }
                }
            });
        }

        function updateMatrixPieChart(aspirado, turbo) {
            const ctx = document.getElementById('matrixPieChart').getContext('2d');
            
            if (matrixPieChart) {
                matrixPieChart.destroy();
            }
            
            matrixPieChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Aspirado', 'Turbo'],
                    datasets: [{
                        data: [aspirado, turbo],
                        backgroundColor: ['rgba(52, 152, 219, 0.7)', 'rgba(155, 89, 182, 0.7)'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function updateDealersPieChart(aspirado, turbo) {
            const ctx = document.getElementById('dealersPieChart').getContext('2d');
            
            if (dealersPieChart) {
                dealersPieChart.destroy();
            }
            
            dealersPieChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Aspirado', 'Turbo'],
                    datasets: [{
                        data: [aspirado, turbo],
                        backgroundColor: ['rgba(52, 152, 219, 0.7)', 'rgba(155, 89, 182, 0.7)'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function updateLeadsTrendChart(labels, totalData, matrixData, dealersData) {
            const ctx = document.getElementById('leadsTrendChart').getContext('2d');
            
            if (leadsTrendChart) {
                leadsTrendChart.destroy();
            }
            
            leadsTrendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Total de Leads',
                            data: totalData,
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            fill: true,
                            tension: 0.3
                        },
                        {
                            label: 'Leads Matriz',
                            data: matrixData,
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            fill: true,
                            tension: 0.3
                        },
                        {
                            label: 'Leads Dealers',
                            data: dealersData,
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            fill: true,
                            tension: 0.3
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function updateChannelDistributionChart(matrixTotal, dealersTotal) {
            const ctx = document.getElementById('channelDistributionChart').getContext('2d');
            
            if (channelDistributionChart) {
                channelDistributionChart.destroy();
            }
            
            channelDistributionChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Matriz', 'Dealers'],
                    datasets: [{
                        data: [matrixTotal, dealersTotal],
                        backgroundColor: ['#2ecc71', '#e74c3c'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function formatDisplayDate(dateString) {
            const date = new Date(dateString);
            const day = date.getDate().toString().padStart(2, '0');
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            return `${day}/${month}`;
        }
    </script>
</body>
</html>
